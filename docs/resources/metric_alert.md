---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "sentry_metric_alert Resource - terraform-provider-sentry"
subcategory: ""
description: |-
  Sentry Metric Alert resource.
---

# sentry_metric_alert (Resource)

Sentry Metric Alert resource.

## Example Usage

```terraform
data "sentry_organization_integration" "slack" {
  organization = sentry_project.main.organization
  provider_key = "slack"
  name         = "Slack Workspace" # Name of your Slack workspace
}

resource "sentry_metric_alert" "main" {
  organization      = sentry_project.main.organization
  project           = sentry_project.main.id
  name              = "My metric alert"
  dataset           = "events"
  query             = ""
  aggregate         = "count()"
  time_window       = 60
  threshold_type    = 0
  resolve_threshold = 0

  trigger {
    action {
      type              = "email"
      target_type       = "team"
      target_identifier = sentry_team.main.internal_id
    }
    alert_threshold = 300
    label           = "critical"
    threshold_type  = 0
  }

  trigger {
    action {
      type              = "slack"
      target_type       = "specific"
      target_identifier = "#slack-channel"
      input_channel_id  = "C0XXXXXXXXX"
      integration_id    = data.sentry_organization_integration.slack.id
    }
    alert_threshold = 300
    label           = "critical"
    threshold_type  = 0
  }

  trigger {
    alert_threshold = 100
    label           = "warning"
    threshold_type  = 0
  }
}

# Example: Metric Alert with Sentry App Action
data "sentry_organization_integration" "rootly" {
  organization = "my-organization"
  name         = "Rootly"
}

resource "sentry_metric_alert" "main" {
  organization   = "my-organization"
  project        = "my-project"
  name           = "My Alert with Rootly"
  dataset        = "events"
  event_types    = ["error"]
  query          = ""
  aggregate      = "count()"
  time_window    = 60
  threshold_type = 0

  trigger {
    action {
      type              = "sentry_app"
      target_type       = "sentry_app"
      target_identifier = data.sentry_organization_integration.rootly.internal_id
      sentry_app_id     = tonumber(data.sentry_organization_integration.rootly.internal_id)
      integration_id    = 0
    }
    alert_threshold = 100
    label           = "critical"
    threshold_type  = 0
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `aggregate` (String) The aggregation criteria to apply
- `name` (String) The metric alert name.
- `organization` (String) The slug of the organization the metric alert belongs to.
- `project` (String) The slug of the project to create the metric alert for.
- `query` (String) The query filter to apply
- `threshold_type` (Number) The type of threshold
- `time_window` (Number) The period to evaluate the Alert rule in minutes
- `trigger` (Block List, Min: 1) (see [below for nested schema](#nestedblock--trigger))

### Optional

- `comparison_delta` (Number) An optional int representing the time delta to use as the comparison period, in minutes. Required when using a percentage change threshold
- `dataset` (String) The Sentry Alert category
- `environment` (String) Perform Alert rule in a specific environment
- `event_types` (List of String) The events type of dataset.
- `owner` (String) Specifies the owner id of this Alert rule
- `resolve_threshold` (Number) The value at which the Alert rule resolves

### Read-Only

- `id` (String) The ID of the metric alert.
- `internal_id` (String) The internal ID for this metric alert.

<a id="nestedblock--trigger"></a>
### Nested Schema for `trigger`

Required:

- `action` (Block List, Min: 1) (see [below for nested schema](#nestedblock--trigger--action))
- `alert_threshold` (Number)
- `label` (String)
- `threshold_type` (Number)

Optional:

- `resolve_threshold` (Number)

Read-Only:

- `id` (String) The ID of the trigger.

<a id="nestedblock--trigger--action"></a>
### Nested Schema for `trigger.action`

Required:

- `target_type` (String)
- `type` (String)

Optional:

- `input_channel_id` (String) Slack channel ID to avoid rate-limiting, see [here](https://docs.sentry.io/product/integrations/notification-incidents/slack/#rate-limiting-error)
- `integration_id` (Number)
- `priority` (String)
- `sentry_app_id` (Number) The ID of the Sentry App (required when type is sentry_app)
- `target_identifier` (String)

Read-Only:

- `id` (String) The ID of the action.

## Import

Import is supported using the following syntax:

The [`terraform import` command](https://developer.hashicorp.com/terraform/cli/commands/import) can be used, for example:

```shell
# import using the organization, project slugs and rule id from the URL:
# https://sentry.io/organizations/[org-slug]/projects/[project-slug]/
# https://sentry.io/organizations/[org-slug]/alerts/rules/details/[rule-id]/
# or
# https://sentry.io/organizations/[org-slug]/alerts/metric-rules/[project-slug]/[rule-id]/
terraform import sentry_metric_alert.default org-slug/project-slug/rule-id
```
